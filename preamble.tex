\documentclass[10pt,a4paper,notitlepage]{article}
\usepackage{hyperref}
\usepackage[spanish,es-tabla]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{listings}
\usepackage{listingsutf8}
\usepackage{amssymb}
\usepackage[usenames,dvipsnames]{color}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{amsmath}
\usepackage{makeidx}

%%% Margenes
\addtolength{\textheight}{1.5in}
\addtolength{\topmargin}{-0.75in}

\addtolength{\textwidth}{1.8in}
\addtolength{\oddsidemargin}{-0.9in}

\setlength{\headsep}{0.08in}
\setlength{\parskip}{0in}
\setlength{\headheight}{15pt}
\setlength{\parindent}{0mm}

%%% Encabezado y pie de pagina
\pagestyle{fancy}
\fancyhead[LO]{\textbf{\title}}
\fancyhead[C]{\leftmark\ -\ \rightmark}
\fancyhead[RO]{Page \thepage\ of \pageref{LastPage}}
\renewcommand{\headrulewidth}{0.4pt}
\fancyfoot{}
\definecolor{darkblue}{rgb}{0,0,0.4}
%%% Configuracion de Listings
\lstloadlanguages{C++}
\lstnewenvironment{code}
    {\csname lst@SetFirstLabel\endcsname}
    {\csname lst@SaveFirstLabel\endcsname}
\lstset{% general command to set parameter(s)
    language=C++, basicstyle=\small\ttfamily, keywordstyle=\slshape,
    emph=[1]{tipo,usa}, emphstyle={[1]\sffamily\bfseries},
    morekeywords={tint,forn,forsn,fore},
    basewidth={0.47em,0.40em},
    columns=fixed, fontadjust, resetmargins, xrightmargin=5pt, xleftmargin=15pt,
    flexiblecolumns=false, tabsize=2, breaklines, breakatwhitespace=false, extendedchars=true,
    inputencoding=utf8/latin1,
    numbers=left, numberstyle=\tiny, stepnumber=1, numbersep=9pt,
    frame=l, framesep=3pt,
    basicstyle=\ttfamily,
    keywordstyle=\color{darkblue}\ttfamily,
    stringstyle=\color{magenta}\ttfamily,
    commentstyle=\color{OliveGreen}\ttfamily,
    morecomment=[l][\color{Purple}]{\#}
}

\lstdefinestyle{C++}{
    language=C++, basicstyle=\small\ttfamily, keywordstyle=\slshape,
    emph=[1]{tipo,usa,tipo2}, emphstyle={[1]\sffamily\bfseries},
    morekeywords={tint,forn,forsn,fore},
    basewidth={0.47em,0.40em},
    columns=fixed, fontadjust, resetmargins, xrightmargin=5pt, xleftmargin=15pt,
    flexiblecolumns=false, tabsize=2, breaklines, breakatwhitespace=false, extendedchars=true,
    inputencoding=utf8/latin1,
    numbers=left, numberstyle=\tiny, stepnumber=1, numbersep=9pt,
    frame=l, framesep=3pt,
    basicstyle=\ttfamily,
    keywordstyle=\color{darkblue}\ttfamily,
    stringstyle=\color{magenta}\ttfamily,
    commentstyle=\color{OliveGreen}\ttfamily,
    morecomment=[l][\color{Purple}]{\#}
}

%%% Macros
\def\nbtitle#1{\begin{Large}\begin{center}\textbf{#1}\end{center}\end{Large}}
\def\nbsection#1{\section{#1}}
\def\nbsubsection#1{\subsection{#1}}
\def\nbcoment#1{\begin{small}\textbf{#1}\end{small}}
\newcommand{\comb}[2]{\left( \begin{array}{c} #1 \\ #2 \end{array}\right)}
\def\complexity#1{\texorpdfstring{$\mathcal{O}(#1)$}{O(#1)}}
\newcommand\cppfile[2][]{
    \lstinputlisting[style=C++,#1]{\detokenize{#2}}
}
